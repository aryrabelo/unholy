---
- name: Ensure plex dependencies are installed.
  action: apt pkg={{ item }} state=present
  with_items:
    - libavahi-common3
    - libavahi-core7
    - libdaemon0
    - libnss-mdns
    - libavahi-client3
    - libavahi-common3
    - avahi-daemon
    - avahi-utils
  ignore_errors: yes
- name: Running apt-get -f install to fix any potential problems the last command had.
  command: apt-get -f install
#- name: Add plex ubuntu repo.
#  apt_repository: repo="deb http://plex.r.worldssl.net/PlexMediaServer/ubuntu-repo lucid main" state=present
#- name: Add plex key.
#  apt_key: url="http://plexapp.com/plex_pub_key.pub"
- name: Download plex .deb
  #get_url: url={{ plex_download }} dest={{ plex_deb_path }} sha256sum={{ sha256_sum}}
  command: wget -nc {{ plex_download }} -O {{ plex_deb_path }}
  ignore_errors: yes
- name: Ensure plex is installed.
  command: dpkg -i {{ plex_deb_path }}
- name: Ensure plex is running.
  service: name=plexmediaserver state=started
